リファクタリング途中なのでソースがすごく汚いです
